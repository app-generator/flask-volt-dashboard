{% extends "layouts/base.html" %}

{% block title %} All Reviews {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

<form method="post" action="">
  <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-3">
    <div class="d-block mb-2 mb-md-0">
      <nav aria-label="breadcrumb" class="d-none d-md-inline-block">
        <ol class="breadcrumb breadcrumb-dark breadcrumb-transparent">
          <li class="breadcrumb-item">
            <a href="/">
              <svg class="icon icon-xxs" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
              </svg>
            </a>
          </li>
          <li class="breadcrumb-item"><a href="/dashboard.html">Dashboard</a></li>
          <li class="breadcrumb-item active" aria-current="page">All Reviews</li>
        </ol>
      </nav>
      <h2 class="h4">All Reviews</h2>
      <a class="dropdown-item d-flex align-items-center fw-bold" data-toggle="modal" data-target="#modalDownload" role="dialog">
        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 27 27" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="bevel"><path d="M3 15v4c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-4M17 9l-5 5-5-5M12 12.8V2.5"/></svg>
        &nbsp Download
      </a>
    </div>
  </div>
  <div class="card card-body border-0 shadow table-wrapper table-responsive">
    <table class="table table-hover">
      <thead>
        <tr>
          <th class="border-gray-200">#</th>
          <th class="border-gray-200">Source Lang.</th>                     
          <th class="border-gray-200">Target Lang.</th>
          <th class="border-gray-200">Source Text</th>
          <th class="border-gray-200">Translation</th>
          <th class="border-gray-200">Reviewed Text</th>
          <th class="border-gray-200">Comment</th>
          <th class="border-gray-200">Date</th>
          <th class="border-gray-200">Actions</th>
        </tr>
      </thead>
      <tbody>
        <!-- Items -->
        {% for review in reviews %}

        <tr>
          <td>
            <a href="#" class="fw-bold">
              {{ loop.index + pagination.skip }}
            </a>
          </td>
          <td>
            <span class="fw-normal">
              {% if review.sl|length > 11 %}
              {{ review.sl[:11] }}...
              {% else %}
              {{ review.sl }}
              {% endif %}
            </span>
          </td>
          <td>
            <span class="fw-normal">
              {% if review.tl|length > 11 %}
              {{ review.tl[:11] }}...
              {% else %}
              {{ review.tl }}
              {% endif %}
            </span>
          </td>                        
          <td>
            <span class="fw-normal">
              {% if review.text|length > 15 %}
              {{ review.text[:15] }}...
              {% else %}
              {{ review.text }}
              {% endif %}
            </span>
          </td>
          <td>
            <span class="fw-normal">
              {% if review.translation|length > 15 %}
              {{ review.translation[:15] }}...
              {% else %}
              {{ review.translation }}
              {% endif %}
            </span>
          </td>
          <td>
            <span class="fw-bold text-warning">
              {% if review.reviewed|length > 15 %}
              {{ review.reviewed[:15] }}...
              {% else %}
              {{ review.reviewed }}
              {% endif %}
            </span>
          </td>
          <td>
            <span class="fw-normal">
              {% if review.comment %}
              {% if review.comment|length > 15 %}
              {{ review.comment[:15] }}...
              {% else %}
              {{ review.comment }}
              {% endif %}
              {% else %}
              <i>No comment...</i>
              {% endif %}
            </span>
          </td>
          <td><span class="fw-normal">{{ review.reviewed_at.strftime('%d-%m-%Y') }}</span></td>
          <td class="text-center">
            <div class="btn-group">
              <button class="btn btn-link text-dark dropdown-toggle dropdown-toggle-split m-0 p-0" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <span class="icon icon-sm">
                  <span class="fas fa-ellipsis-h icon-dark"></span>
                </span>
                <span class="icon">
                  <svg class="icon icon-xs me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path></svg>
                </span>
              </button>
              <div class="dropdown-menu py-0">
                <a class="dropdown-item rounded-top" data-toggle="modal" data-target="#viewReview{{review.id}}" role="dialog"><span class="fas fa-eye me-2"></span>View Details</a>
                <a class="dropdown-item" data-toggle="modal" data-target="#editReview{{review.id}}" role="dialog"><span class="fas fa-edit me-2"></span>Edit</a>
                <a class="dropdown-item text-danger rounded-bottom" href="#"><span class="fas fa-trash-alt me-2"></span>Remove</a>
              </div>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="card-footer px-3 border-0 d-flex flex-column flex-lg-row align-items-center justify-content-between">
      <nav aria-label="Page navigation example">
        {{pagination.links}}
      </nav>
      <div class="fw-normal small mt-4 mt-lg-0"><strong>{{ pagination.info }}</strong></div>
    </div>

  </div>

  {% for review in reviews %}
  <!-- Modal -->
  <div class="modal fade" id="viewReview{{review.id}}" role="dialog">
    <div class="modal-dialog modal-lg">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Review Information</h4>
          <a name="translate" value="translate" class="close" data-dismiss="modal">
            <svg xmlns="http://www.w3.org/2000/svg" width="41" height="41" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
          </a>
        </div>
        <div class="modal-body">
          <table class="table table-hover">
            <tbody>
              <tr>
                <td class="col-md-1">
                  <span class="fw-bold">
                    ID:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.id }}
                  </span>
                </td>
              </tr>
              <tr>
                <td>
                  <span class="fw-bold">
                    Direction:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.sl }} --> {{ review.tl }}
                  </span>
                </td>
              </tr>
              <tr>
                <td>
                  <span class="fw-bold">
                    Text:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.text }}
                  </span>
                </td>
              </tr>
              <tr>
                <td>
                  <span class="fw-bold">
                    Translation:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.translation }}
                  </span>
                </td>
              </tr>
              <tr>
                <td>
                  <span class="fw-bold">
                    Review:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.reviewed }}
                  </span>
                </td>
              </tr>
              <tr>
                <td>
                  <span class="fw-bold">
                    Comment:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.comment }}
                  </span>
                </td>
              </tr>
              <tr>
                <td>
                  <span class="fw-bold">
                    Time:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.reviewed_at.strftime("%d-%m-%Y @ %h.%mm a") }}
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

    </div>
  </div>

  {% endfor %}

  {% for review in reviews %}
  <!-- Modal -->
  <div class="modal fade" id="editReview{{review.id}}" role="dialog">
    <div class="modal-dialog modal-lg">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Edit Review</h4>
          <a name="translate" value="translate" class="close" data-dismiss="modal">
            <svg xmlns="http://www.w3.org/2000/svg" width="41" height="41" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
          </a>
        </div>
        <div class="modal-body">
          <table class="table table-hover">
            <tbody>
              <tr>
                <td class="col-md-1">
                  <span class="fw-bold">
                    Direction:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.sl }} --> {{ review.tl }}
                  </span>
                </td>
              </tr>
              <tr>
                <td>
                  <span class="fw-bold">
                    Text:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.text }}
                  </span>
                </td>
              </tr>
              <tr>
                <td>
                  <span class="fw-bold">
                    Translation:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.translation }}
                  </span>
                </td>
              </tr>
              <tr>
                <td class="text-right">
                  <span class="fw-bold">
                    Review:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.reviewed }}
                  </span>
                </td>
              </tr>
              <tr>
                <td>
                  <span class="fw-bold">
                    Comment:
                  </span>
                </td>
                <td>
                  <span class="fw-normal">
                    {{ review.comment }}
                  </span>
                </td>
              </tr>
              <tr>
                <td class="text-right">
                  <span class="fw-bold">
                    Edit:
                  </span>
                </td>
                <td>
                  <textarea class="form-control mb-2" id="t2t" name="t2t" rows="4">{{ review.reviewed }}</textarea>
                  <button type="button" class="btn btn-primary float-right d-inline-flex align-items-center" data-dismiss="modal">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg> Save
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

    </div>
  </div>

  {% endfor %}

  <div class="modal fade" id="modalDownload" role="dialog">
    <div class="modal-dialog modal-lg">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Download Reviews</h4>
          <a id="closeDownload" class="close" data-dismiss="modal">
            <svg xmlns="http://www.w3.org/2000/svg" width="41" height="41" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
          </a>
        </div>

        <div class="modal-body">
         <table class="table responsive">
           <tbody>
             <tr>
               <td class="col-md-3">
                 <div class="form-check form-switch mb-0">
                   <input class="form-check-input" type="checkbox" name="allDownload" id="allDownload" value="allDownload" checked>
                   <label class="form-check-label" for="allDownload">All</label>
                 </div>
               </td>
               <td>
                 <div class="form-check form-switch mb-0">
                   <input class="form-check-input" type="checkbox" name="filterDownload" id="filterDownload" value="filterDownload">
                   <label class="form-check-label" for="filterDownload">Filter</label>
                 </div>
               </td><td></td>
             </tr>
             <tr class="filterDownloadSection" style="display: none;">
               <td>
                 <div class="form-check form-switch mb-0">
                   <input class="form-check-input" type="checkbox" name="daterange" id="daterange" value="daterange">
                   <label class="form-check-label" for="daterange">Date Range</label>
                 </div>
               </td>
               <td>
                 <div class="dateRangeSection" style="display: none;">
                   <label for="startdate">
                     <svg class="icon icon-xs text-gray-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path></svg>
                     Start Date
                   </label>
                   <input data-datepicker="" class="form-control" id="startdate" name="startdate" type="text" placeholder="dd/mm/yyyy">
                 </div>
               </td>
               <td>
                 <div class="dateRangeSection" style="display: none;">
                   <label for="enddate">
                     <svg class="icon icon-xs text-gray-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path></svg>
                     End Date
                   </label>
                   <input data-datepicker="" class="form-control" id="enddate" name="enddate" type="text" placeholder="dd/mm/yyyy">
                 </div>
               </td>
             </tr>
             <tr class="filterDownloadSection" style="display: none;">
               <td>
                 <div class="form-check form-switch mb-0">
                   <input class="form-check-input" type="checkbox" name="langpair" id="langpair" value="langpair">
                   <label class="form-check-label" for="langpair">Language Pair</label>
                 </div>
               </td>
               <td>
                 <div class="langPairSection" style="display: none;">
                   <label class="my-1 me-2" for="slang"><span class="ms-1 mb-0 fs-6 text-gray-800">Source Language</span></label>
                   <select class="form-select" id="slang" name="slang" aria-label="Default source language">
                     <option value="">Select Source Language</option>
                     <option value="1">Ndyuka (Aukaans)</option>
                     <option value="2">English</option>
                     <option value="3">French</option>
                   </select>
                 </div>
               </td>
               <td>
                 <div class="langPairSection" style="display: none;">
                   <label class="my-1 me-2" for="tlang"><span class="ms-1 mb-0 fs-6 text-gray-800">Target Language</span></label>
                   <select class="form-select" id="tlang" name="tlang" aria-label="Default target language">
                     <option value="">Select Source Language</option>
                     <option value="1">Ndyuka (Aukaans)</option>
                     <option value="2">English</option>
                     <option value="3">French</option>
                   </select>
                 </div>
               </td>
             </tr>
             <tr>
              <td colspan="3">
               <button type="submit" id="download" value="download" class="btn btn-primary float-end">
                 <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 27 27" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="bevel"><path d="M3 15v4c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-4M17 9l-5 5-5-5M12 12.8V2.5"/></svg>Download
               </button>
             </td>
           </tr>
         </tbody>
       </table> 
     </div>
   </div>
 </div>
</div>
</form>

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<script type="text/javascript">

  $('input[name="allDownload"]').click(function() {
    $("#filterDownload").prop("checked", false);
    $("#startdate").val("");
    $("#enddate").val("");
    $("#slang").val("");
    $("#tlang").val("");
    $("#langpair").prop("checked", false);
    $("#daterange").prop("checked", false);
    $('.dateRangeSection').toggle(false);
    $('.langPairSection').toggle(false);
    $('.filterDownloadSection').toggle(false);
  });

  $('input[name="filterDownload"]').click(function() {
    $("#allDownload").prop("checked", false);
    $('.filterDownloadSection').toggle(this.checked);
  });

  $('input[name="daterange"]').click(function() {
    $('.dateRangeSection').toggle(this.checked);
    $("#startdate").val("");
    $("#enddate").val("");
  });

  $('input[name="langpair"]').click(function() {
    $('.langPairSection').toggle(this.checked);
    $("#slang").val("");
    $("#tlang").val("");
  });

  $("#downloadButton").click(function () {

    if ($("#fortoggle").val() === "0") {
      $("#fortoggle").val("1");
      $(".downloadSection").toggle(true);
    }

    else {
      $("#fortoggle").val("0");
      $(".downloadSection").toggle(false);
      $("#filterDownload").prop("checked", false);
      $("#allDownload").prop("checked", true);
      $("#startdate").val("");
      $("#enddate").val("");
      $("#slang").val("");
      $("#tlang").val("");
      $("#langpair").prop("checked", false);
      $("#daterange").prop("checked", false);
      $('.dateRangeSection').toggle(false);
      $('.langPairSection').toggle(false);
      $('.filterDownloadSection').toggle(false);
    }

  });

</script>

{% endblock javascripts %}